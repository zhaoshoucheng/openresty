some of them borrow from https://github.com/openresty/lua-resty-balancer